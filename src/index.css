@tailwind base;
@tailwind components;
@tailwind utilities;

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Base colors - Light Theme: #F3F3E3, #A9CFE0, #606F69 */
    --background: 60 4% 92%;  /* #F3F3E3 */
    --foreground: 147 7% 42%; /* #606F69 */

    /* Surface colors */
    --surface: 60 4% 95%;     /* Slightly lighter than background */
    --surface-elevated: 0 0% 100%; /* Pure white for elevated elements */
    --surface-glass: 60 4% 92% / 0.8;

    /* Card colors */
    --card: 60 4% 95%;        /* Slightly differentiated from background */
    --card-foreground: 147 7% 42%; /* #606F69 */

    /* Popover colors */
    --popover: 0 0% 100%;     /* White for better contrast */
    --popover-foreground: 147 7% 42%; /* #606F69 */

    /* Brand colors - Using accent as brand */
    --brand: 196 50% 77%;     /* #A9CFE0 */
    --brand-foreground: 33 19% 16%; /* #2F2A24 for text on accent */
    --brand-muted: 196 50% 77% / 0.1;

    /* Primary colors - Using accent for interactive elements */
    --primary: 196 50% 77%;   /* #A9CFE0 */
    --primary-foreground: 33 19% 16%; /* #2F2A24 */

    /* Secondary colors */
    --secondary: 60 4% 88%;   /* Muted version of background */
    --secondary-foreground: 147 7% 42%; /* #606F69 */

    /* Muted colors */
    --muted: 60 4% 88%;       /* Lighter variation */
    --muted-foreground: 147 7% 42% / 0.7; /* Primary text with opacity */

    /* Accent colors */
    --accent: 196 50% 77%;    /* #A9CFE0 */
    --accent-foreground: 33 19% 16%; /* #2F2A24 */

    /* Destructive colors */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    /* Border and input */
    --border: 147 7% 42% / 0.2; /* Primary text with low opacity */
    --input: 60 4% 88%;       /* Muted background */
    --ring: 196 50% 77%;      /* Accent color for focus rings */

    --radius: 0.5rem;

    /* Sidebar colors */
    --sidebar-background: 60 4% 95%; /* Slightly differentiated */
    --sidebar-foreground: 147 7% 42%; /* #606F69 */
    --sidebar-primary: 196 50% 77%;  /* #A9CFE0 */
    --sidebar-primary-foreground: 33 19% 16%; /* #2F2A24 */
    --sidebar-accent: 60 4% 88%;     /* Muted */
    --sidebar-accent-foreground: 147 7% 42%; /* #606F69 */
    --sidebar-border: 147 7% 42% / 0.2;
    --sidebar-ring: 196 50% 77%;
  }

  .dark {
    /* Base colors - Dark Theme: #2F2A24, #ABBBC0, #FFFFFF */
    --background: 33 19% 16%;  /* #2F2A24 */
    --foreground: 0 0% 100%;   /* #FFFFFF */

    /* Surface colors */
    --surface: 33 19% 20%;     /* Slightly lighter than background */
    --surface-elevated: 33 19% 24%; /* More elevated surfaces */
    --surface-glass: 33 19% 16% / 0.8;

    /* Card colors */
    --card: 33 19% 20%;        /* Slightly differentiated from background */
    --card-foreground: 0 0% 100%; /* #FFFFFF */

    /* Popover colors */
    --popover: 33 19% 24%;     /* Elevated surface */
    --popover-foreground: 0 0% 100%; /* #FFFFFF */

    /* Brand colors - Using accent as brand */
    --brand: 197 20% 71%;      /* #ABBBC0 */
    --brand-foreground: 33 19% 16%; /* #2F2A24 for text on accent */
    --brand-muted: 197 20% 71% / 0.1;

    /* Primary colors - Using accent for interactive elements */
    --primary: 197 20% 71%;    /* #ABBBC0 */
    --primary-foreground: 33 19% 16%; /* #2F2A24 */

    /* Secondary colors */
    --secondary: 33 19% 20%;   /* Slightly lighter than background */
    --secondary-foreground: 0 0% 100%; /* #FFFFFF */

    /* Muted colors */
    --muted: 33 19% 20%;       /* Lighter variation */
    --muted-foreground: 197 20% 71%; /* Secondary accent color */

    /* Accent colors */
    --accent: 197 20% 71%;     /* #ABBBC0 */
    --accent-foreground: 33 19% 16%; /* #2F2A24 */

    /* Destructive colors */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    /* Border and input */
    --border: 0 0% 100% / 0.1;  /* White with low opacity */
    --input: 33 19% 20%;       /* Muted background */
    --ring: 197 20% 71%;       /* Accent color for focus rings */

    /* Sidebar colors */
    --sidebar-background: 33 19% 20%; /* Slightly differentiated */
    --sidebar-foreground: 0 0% 100%; /* #FFFFFF */
    --sidebar-primary: 197 20% 71%;  /* #ABBBC0 */
    --sidebar-primary-foreground: 33 19% 16%; /* #2F2A24 */
    --sidebar-accent: 33 19% 24%;    /* Elevated */
    --sidebar-accent-foreground: 0 0% 100%; /* #FFFFFF */
    --sidebar-border: 0 0% 100% / 0.1;
    --sidebar-ring: 197 20% 71%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-sans;
  }

  /* Custom scrollbar styles */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-muted;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/30 rounded-md;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground/50;
  }

  /* Dark mode scrollbar */
  .dark ::-webkit-scrollbar-track {
    @apply bg-surface;
  }

  .dark ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/40;
  }

  .dark ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground/60;
  }
}

@layer components {
  /* Glass effect utilities */
  .glass-effect {
    @apply backdrop-blur-lg bg-surface-glass border border-border/50;
  }

  /* Panel resize handle */
  .resize-handle {
    @apply w-1 bg-border hover:bg-accent cursor-col-resize transition-colors relative;
  }

  .resize-handle:hover::after {
    content: '';
    @apply absolute inset-y-0 -left-1 -right-1 bg-accent/20;
  }

  /* Message bubble animations */
  .message-bubble {
    @apply animate-fade-in-up;
  }

  /* Loading skeleton */
  .skeleton {
    @apply bg-muted animate-pulse-fast rounded;
  }

  /* Rainbow text effect */
  .rainbow-text {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbow-shine 3s ease-in-out infinite;
  }

  /* Notification styles */
  .notification {
    @apply fixed top-4 right-4 z-50 animate-slide-in-right;
  }

  /* ===== ENHANCED TOOLS & ADD MENU STYLES ===== */
  
  /* Tools Button - Initial state with lightweight border */
  .tools-button {
    @apply relative flex items-center gap-2 px-3 py-1.5 text-sm 
           border border-border/30 rounded-full 
           text-muted-foreground bg-background/50
           transition-all duration-150 ease-out
           hover:scale-105 hover:border-border/60 hover:text-foreground
           hover:bg-accent/20 hover:shadow-sm
           focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
           focus-visible:outline-none;
  }

  /* Dropdown menus - shared base styles */
  .menu-dropdown {
    @apply fixed z-50 bg-popover border border-border rounded-lg shadow-lg backdrop-blur-md
           min-w-[220px] overflow-hidden;
  }

  /* Tools Menu - vertical layout */
  .tools-menu {
    @apply menu-dropdown py-2;
    animation: menu-fade-in-up 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  .tools-menu.closing {
    animation: menu-fade-out-down 150ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  /* Tools Menu Items - 48px height, icon left, centered text */
  .tools-menu-item {
    @apply relative flex items-center gap-3 px-4 h-12 text-sm text-foreground
           cursor-pointer overflow-hidden
           transition-all duration-120 ease-out
           hover:bg-accent/20 hover:scale-103 hover:text-accent-foreground
           focus-visible:bg-accent/30 focus-visible:outline-none;
  }

  .tools-menu-item .icon {
    @apply w-4 h-4 flex-shrink-0 transition-colors duration-120;
  }

  .tools-menu-item:hover .icon {
    @apply text-accent;
  }

  /* Ripple effect */
  .tools-menu-item::after {
    content: '';
    @apply absolute inset-0 pointer-events-none opacity-0;
    background: radial-gradient(circle at var(--ripple-x, 50%) var(--ripple-y, 50%), hsl(var(--accent)) 0%, transparent 70%);
    transform: scale(0);
    transition: transform 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67), opacity 200ms;
  }

  .tools-menu-item.ripple::after {
    @apply opacity-20;
    animation: ripple 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  /* Add Menu - horizontal layout */
  .add-menu {
    @apply menu-dropdown flex;
    animation: menu-fade-in-up 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  .add-menu.closing {
    animation: menu-fade-out-down 150ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  .add-menu-item {
    @apply flex items-center gap-2 px-4 py-3 text-sm text-foreground
           cursor-pointer whitespace-nowrap
           transition-all duration-120 ease-out
           hover:bg-accent/20 hover:text-accent-foreground
           focus-visible:bg-accent/30 focus-visible:outline-none;
  }

  .add-menu-item:not(:last-child) {
    @apply border-r border-border/30;
  }

  /* Sub-menu panel */
  .submenu-panel {
    @apply absolute left-full top-0 ml-1 bg-popover border border-border rounded-lg shadow-lg
           backdrop-blur-md min-w-[200px] py-2 z-60;
    animation: submenu-slide-in 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  .submenu-panel.closing {
    animation: submenu-slide-out 150ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  .submenu-item {
    @apply relative flex items-center gap-3 px-4 py-3 text-sm text-foreground
           cursor-pointer overflow-hidden
           transition-all duration-120 ease-out
           hover:bg-accent/20 hover:text-accent-foreground
           focus-visible:bg-accent/30 focus-visible:outline-none;
  }

  /* Underline animation for submenu items */
  .submenu-item::after {
    content: '';
    @apply absolute bottom-1 left-4 right-4 h-px bg-accent scale-x-0 transition-transform duration-200;
  }

  .submenu-item:hover::after {
    animation: underline-expand 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
  }

  /* Mobile responsive - bottom sheet behavior */
  @media (max-width: 768px) {
    .tools-menu {
      @apply fixed bottom-0 left-0 right-0 rounded-t-xl rounded-b-none p-4 max-h-[70vh] overflow-y-auto;
      animation: mobile-slide-up 250ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
    }

    .tools-menu.closing {
      animation: mobile-slide-down 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
    }

    .tools-menu-item {
      @apply h-14 px-6 text-base; /* Larger touch targets */
    }

    .add-menu {
      @apply fixed bottom-0 left-0 right-0 flex-col rounded-t-xl rounded-b-none p-4;
      animation: mobile-slide-up 250ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
    }

    .add-menu.closing {
      animation: mobile-slide-down 200ms cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
    }

    .add-menu-item {
      @apply py-4 border-r-0 border-b border-border/30;
    }

    .add-menu-item:last-child {
      @apply border-b-0;
    }
  }

  /* Mobile overlay backdrop */
  .mobile-backdrop {
    @apply fixed inset-0 bg-background/80 backdrop-blur-sm z-40;
  }

  /* Focus states for keyboard navigation */
  .menu-item-focused {
    @apply bg-accent/30 ring-2 ring-ring ring-offset-2 ring-offset-background;
  }

  /* High contrast focus outlines */
  @media (prefers-contrast: high) {
    .tools-button:focus-visible,
    .tools-menu-item:focus-visible,
    .add-menu-item:focus-visible,
    .submenu-item:focus-visible {
      @apply ring-4 ring-ring;
    }
  }

  /* Reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .tools-menu,
    .add-menu,
    .submenu-panel {
      animation: none !important;
    }

    .tools-button,
    .tools-menu-item,
    .add-menu-item,
    .submenu-item {
      transition: none !important;
    }
  }
}